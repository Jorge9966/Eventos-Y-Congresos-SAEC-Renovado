<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Registrarme - Eventos y Congresos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    html,body{height:100%;}
    body{display:flex; align-items:stretch;}
    .left-side{flex:0 0 40%; background:#fff; display:flex; align-items:center; justify-content:center;}
    .right-side{flex:0 0 60%; background:#26343a; color:#fff; display:flex; align-items:flex-start; justify-content:center; padding:40px 0;}
    .form-wrap{ width:420px; }
    .form-wrap h2{ color:#fff; font-weight:700; }
    .form-control{ border-radius:8px; }
    .btn-primary{ background:#0d6efd; border-color:#0d6efd; }
    .tabs { display:flex; gap:24px; margin-bottom:18px; }
    .tabs a{ color:rgba(255,255,255,0.7); text-decoration:none; padding-bottom:6px; border-bottom:2px solid transparent; }
    .tabs a.active{ color:#fff; border-bottom-color:rgba(255,255,255,0.2); }
    .small-muted{ color:rgba(255,255,255,0.6); }
    .logo-img{ max-width:360px; }
    .hint{ color:rgba(255,255,255,0.75); font-size:0.9rem; }
    .role-buttons { display:flex; gap:15px; margin:20px 0; }
    .role-btn { flex:1; border-radius:30px; padding:10px; border:2px solid #0d6efd; background:transparent; color:#0d6efd; font-weight:600; cursor:pointer; text-align:center; }
    .role-btn.active { background:#0d6efd; color:#fff; }
    @media (max-width:900px){ body{flex-direction:column;} .left-side,.right-side{width:100%;} }
  </style>
</head>
<body>
  <div class="left-side">
    <img src="/static/images/logo_isc.png" alt="ISC" class="logo-img">
  </div>
  <div class="right-side">
    <div class="form-wrap">
      <h2>Registrarme</h2>
      <p class="small-muted">Rellena los campos para crear una cuenta</p>

      <!-- Tabs originales -->
      <div class="tabs mt-4">
        <a href="{% url 'events:login' %}">Login</a>
        <a class="active" href="{% url 'events:register' %}">Registrarme</a>
      </div>

      <!-- Botones de tipo de usuario -->
      <div class="role-buttons">
        <div id="btn-participante" class="role-btn active" onclick="seleccionarTipo('participante')">Participante</div>
        <div id="btn-instructor" class="role-btn" onclick="seleccionarTipo('instructor')">Instructor</div>
      </div>

      {% if messages %}
        {% for m in messages %}
          <div class="alert alert-{{ m.tags }}">{{ m }}</div>
        {% endfor %}
      {% endif %}

      <form method="post" action="">
        {% csrf_token %}
        <input type="hidden" name="tipo_usuario" id="tipo_usuario" value="participante">

        <div class="mb-3"><input name="first_name" type="text" class="form-control" placeholder="Nombre(s)" required></div>
        <div class="mb-3"><input name="apellido_paterno" type="text" class="form-control" placeholder="Apellido Paterno" required></div>
        <div class="mb-3"><input name="apellido_materno" type="text" class="form-control" placeholder="Apellido Materno" required></div>
        <div class="mb-3"><input name="email" type="email" class="form-control" placeholder="Correo Institucional" required></div>
        <div class="mb-3 position-relative">
          <input id="password" name="password" type="password" class="form-control" placeholder="ContraseÃ±a" required>
          <button type="button" class="btn btn-primary" 
                  style="position:absolute; right:-2px; top:0; height:100%; border-radius:0 8px 8px 0;" 
                  onclick="togglePassword('password', this)">
            <i class="bi bi-eye-slash"></i>
          </button>
        </div>

        <!-- Campo extra solo para instructores -->
        <div class="mb-3 d-none" id="clave_instructor_wrap">
          <input name="clave_instructor" type="text" class="form-control" placeholder="Clave de Instructor">
        </div>

        <div class="mb-4">
          <button class="btn btn-light w-100" style="color:#0d6efd; border-radius:8px;">Registrarme</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    function seleccionarTipo(tipo) {
      document.getElementById("tipo_usuario").value = tipo;

      // Cambiar estilos de botones
      document.getElementById("btn-participante").classList.remove("active");
      document.getElementById("btn-instructor").classList.remove("active");
      document.getElementById("btn-" + tipo).classList.add("active");

      // Mostrar/ocultar campo clave
      if (tipo === "instructor") {
        document.getElementById("clave_instructor_wrap").classList.remove("d-none");
      } else {
        document.getElementById("clave_instructor_wrap").classList.add("d-none");
      }
    }
  </script>
  <script>
    function togglePassword(inputId, btn) {
      const input = document.getElementById(inputId);
      const icon = btn.querySelector("i");

      if (input.type === "password") {
        input.type = "text";
        icon.classList.remove("bi-eye-slash");
        icon.classList.add("bi-eye");
      } else {
        input.type = "password";
        icon.classList.remove("bi-eye");
        icon.classList.add("bi-eye-slash");
      }
    }
  </script>
</body>
</html>